<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alat Bantuan — Down Syndrome (Demo)</title>
  <style>
    :root{
      --bg:#f7fbff; --card:#fff; --accent:#0b6efd; --muted:#556; --radius:14px;
      --big:1.6rem; --normal:1.15rem; --micro:0.95rem;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background:linear-gradient(180deg,var(--bg),#eef6ff); color:#123; -webkit-font-smoothing:antialiased;
      padding:18px; display:flex; align-items:flex-start; justify-content:center;
    }
    .app{width:100%; max-width:1100px}
    header{display:flex; gap:16px; align-items:center; margin-bottom:18px}
    header h1{font-size:1.4rem; margin:0}
    .controls{display:flex; gap:8px; margin-left:auto}
    button{background:var(--accent); color:white; border:0; padding:10px 12px; border-radius:10px; font-size:var(--normal); cursor:pointer}
    .grid{display:grid; grid-template-columns: 1fr 420px; gap:16px}
    .card{background:var(--card); border-radius:var(--radius); padding:14px; box-shadow:0 6px 18px rgba(10,30,80,0.06)}
    .section-title{font-weight:700; margin:0 0 10px 0}
    .voice-area textarea{width:100%; min-height:90px; font-size:var(--normal); padding:12px; border-radius:10px; border:1px solid #e3eefc}
    .big-btn{display:block;width:100%; text-align:center; padding:14px; border-radius:12px; font-size:var(--big)}
    .picture-board{display:grid; grid-template-columns: repeat(3,1fr); gap:8px}
    .pic{padding:14px; text-align:center; border-radius:10px; background:linear-gradient(180deg,#fff,#f3f9ff); font-size:28px; cursor:pointer}
    .pic small{display:block; margin-top:8px; font-size:var(--micro)}
    .scheduler-list{display:flex; flex-direction:column; gap:8px}
    .step{display:flex; gap:8px; align-items:center; padding:8px; border-radius:8px; border:1px dashed #dcecff}
    .game-area{display:flex; flex-direction:column; gap:10px}
    .drag-list{display:flex; gap:8px; flex-wrap:wrap}
    .drag-item{padding:10px;border-radius:8px;background:#fff;border:1px solid #e6eefc;cursor:grab}
    .drop-target{min-height:56px; padding:10px;border-radius:8px;border:2px dashed #cfe3ff; display:flex;align-items:center; justify-content:center}
    footer{margin-top:14px; font-size:0.85rem; color:var(--muted)}
    /* Accessibility helpers */
    .large{font-size:1.4rem}
    .hc{background:#000;color:#fff}
    label{font-weight:600}
    input[type=range]{width:100%}
    /* Focus visible */
    button:focus, .pic:focus, .drag-item:focus, .drop-target:focus{outline:3px solid #bfe0ff; outline-offset:2px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Alat Bantuan — Down Syndrome (Demo)</h1>
      <div class="controls" role="toolbar" aria-label="Pengaturan cepat">
        <button id="toggle-large">Ukuran Teks +</button>
        <button id="toggle-contrast">Kontras</button>
      </div>
    </header>

    <main class="grid">
      <div>
        <section class="card voice-area" aria-labelledby="voiceTitle">
          <h2 id="voiceTitle" class="section-title">Baca / Text-to-Speech</h2>
          <label for="ttsText">Tulis kalimat (sederhana):</label>
          <textarea id="ttsText" placeholder="Halo! Saya siap membantu." aria-label="Teks untuk dibacakan">Halo! Selamat datang. Ketuk tombol 'Bacakan' untuk mendengar.</textarea>
          <div style="display:flex; gap:8px; margin-top:8px">
            <button id="speakBtn" class="big-btn">🔊 Bacakan</button>
            <button id="stopBtn" class="big-btn" style="background:#666">⛔ Hentikan</button>
          </div>
          <div style="margin-top:10px">
            <label for="rate">Kecepatan:</label>
            <input id="rate" type="range" min="0.5" max="2" step="0.1" value="1">
          </div>
        </section>

        <section class="card" style="margin-top:14px" aria-labelledby="picTitle">
          <h2 id="picTitle" class="section-title">Picture Board (komunikasi cepat)</h2>
          <p style="margin:0 0 8px 0">Ketuk gambar untuk mendengar kata & berbagi. Gunakan emoji sebagai visual sederhana.</p>
          <div class="picture-board" role="list">
            <button class="pic" data-label="Makan" aria-label="Makan">🍽️<small>Makan</small></button>
            <button class="pic" data-label="Minum" aria-label="Minum">🥤<small>Minum</small></button>
            <button class="pic" data-label="Tidur" aria-label="Tidur">🛏️<small>Tidur</small></button>
            <button class="pic" data-label="Toilet" aria-label="Toilet">🚽<small>Toilet</small></button>
            <button class="pic" data-label="Main" aria-label="Main">⚽<small>Main</small></button>
            <button class="pic" data-label="Sakit" aria-label="Sakit">🤕<small>Sakit</small></button>
          </div>
        </section>

        <section class="card" style="margin-top:14px" aria-labelledby="schedTitle">
          <h2 id="schedTitle" class="section-title">Rutin Harian (Visual schedule)</h2>
          <div style="display:flex; gap:8px; margin-bottom:8px">
            <input id="stepInput" placeholder="Contoh: Sikat gigi" style="flex:1; padding:8px; border-radius:8px; border:1px solid #e3eefc">
            <button id="addStep">Tambah</button>
          </div>
          <div class="scheduler-list" id="schedule"></div>
          <p style="margin-top:8px">Langkah-langkah tersimpan di perangkat (localStorage).</p>
        </section>
      </div>

      <aside>
        <section class="card game-area" aria-labelledby="gameTitle">
          <h2 id="gameTitle" class="section-title">Game Sederhana — Cocokkan</h2>
          <p style="margin:0 0 8px 0">Seret kata ke gambar yang cocok.</p>

          <div style="display:flex; gap:8px; margin-bottom:8px">
            <div style="flex:1">
              <div class="drag-list" id="words">
                <!-- items dynamically created -->
              </div>
            </div>
            <div style="width:140px">
              <div class="drop-target" id="targetA" data-accept="Makan">🍽️</div>
              <div style="height:10px"></div>
              <div class="drop-target" id="targetB" data-accept="Main">⚽</div>
              <div style="height:10px"></div>
              <div class="drop-target" id="targetC" data-accept="Tidur">🛏️</div>
            </div>
          </div>
          <div style="display:flex; gap:8px">
            <button id="shuffle">🔁 Acak</button>
            <button id="check">✅ Cek</button>
          </div>
        </section>

        <section class="card" style="margin-top:14px" aria-labelledby="settingsTitle">
          <h2 id="settingsTitle" class="section-title">Pengaturan Akses</h2>
          <label for="fontSize">Ukuran font utama</label>
          <input id="fontSize" type="range" min="14" max="28" value="16">
          <div style="margin-top:8px">
            <label><input type="checkbox" id="simpleMode"> Mode sederhana (kurangi elemen)</label>
          </div>
        </section>

      </aside>
    </main>

    <footer>
      Tips: Gunakan suara nyata (rekam) bila memungkinkan untuk kenyamanan. Untuk produksi, tambahkan gambar nyata, audio berkualitas, dan dukungan caregiver.
    </footer>
  </div>

  <script>
    // --- Text to Speech ---
    const speakBtn = document.getElementById('speakBtn');
    const stopBtn = document.getElementById('stopBtn');
    const ttsText = document.getElementById('ttsText');
    const rate = document.getElementById('rate');

    function speak(text){
      if(!window.speechSynthesis) return alert('TTS tidak tersedia di browser ini');
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text);
      u.rate = parseFloat(rate.value);
      u.lang = 'id-ID';
      window.speechSynthesis.speak(u);
    }
    speakBtn.addEventListener('click', ()=> speak(ttsText.value || 'Halo'));
    stopBtn.addEventListener('click', ()=> window.speechSynthesis.cancel());

    // Picture board - speak label and copy to clipboard for caregiver
    document.querySelectorAll('.pic').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const label = btn.dataset.label || btn.innerText;
        speak(label);
        if(navigator.clipboard) navigator.clipboard.writeText(label).catch(()=>{});
      });
    });

    // Scheduler (localStorage)
    const scheduleEl = document.getElementById('schedule');
    const stepInput = document.getElementById('stepInput');
    const addStep = document.getElementById('addStep');

    function renderSchedule(){
      const list = JSON.parse(localStorage.getItem('ds_schedule')||'[]');
      scheduleEl.innerHTML='';
      list.forEach((s,i)=>{
        const div = document.createElement('div'); div.className='step';
        div.innerHTML = `<div style="flex:1">${i+1}. ${s}</div><button data-i="${i}">Hapus</button>`;
        scheduleEl.appendChild(div);
      });
      scheduleEl.querySelectorAll('button').forEach(b=> b.addEventListener('click', ()=>{
        const idx = +b.dataset.i; const list = JSON.parse(localStorage.getItem('ds_schedule')||'[]'); list.splice(idx,1); localStorage.setItem('ds_schedule', JSON.stringify(list)); renderSchedule();
      }));
    }
    addStep.addEventListener('click', ()=>{
      const v = stepInput.value.trim(); if(!v) return; const list = JSON.parse(localStorage.getItem('ds_schedule')||'[]'); list.push(v); localStorage.setItem('ds_schedule', JSON.stringify(list)); stepInput.value=''; renderSchedule();
    });
    renderSchedule();

    // Simple matching game
    const words = ['Makan','Main','Tidur'];
    const wordsEl = document.getElementById('words');
    function buildWords(){
      wordsEl.innerHTML='';
      shuffle(words).forEach(w=>{
        const d = document.createElement('div'); d.className='drag-item'; d.tabIndex=0; d.draggable=true; d.textContent = w;
        d.addEventListener('dragstart', e=> e.dataTransfer.setData('text/plain', w));
        d.addEventListener('keydown', e=>{ // keyboard pick up
          if(e.key==='Enter') {
            speak(w);
          }
        });
        wordsEl.appendChild(d);
      });
    }
    function shuffle(a){ return a.slice().sort(()=>Math.random()-0.5); }
    buildWords();

    document.querySelectorAll('.drop-target').forEach(t=>{
      t.addEventListener('dragover', e=> e.preventDefault());
      t.addEventListener('drop', e=>{
        e.preventDefault(); const text = e.dataTransfer.getData('text/plain'); t.textContent = `${t.textContent} \n ${text}`; t.dataset.got = text;
      });
    });

    document.getElementById('shuffle').addEventListener('click', ()=> buildWords());
    document.getElementById('check').addEventListener('click', ()=>{
      let ok = 0; document.querySelectorAll('.drop-target').forEach(t=>{ if(t.dataset.got && t.dataset.got.trim()===t.dataset.accept) ok++; });
      if(ok===3) { speak('Selamat! Semua cocok'); alert('Selamat! Semua cocok'); } else { speak('Coba lagi'); alert('Coba lagi — ada yang belum cocok'); }
    });

    // Accessibility toggles
    const toggleLarge = document.getElementById('toggle-large');
    const toggleContrast = document.getElementById('toggle-contrast');
    toggleLarge.addEventListener('click', ()=> document.body.classList.toggle('large'));
    toggleContrast.addEventListener('click', ()=> document.body.classList.toggle('hc'));

    // Font size control
    document.getElementById('fontSize').addEventListener('input', e=> document.documentElement.style.setProperty('--normal', (e.target.value/16)+'rem'));

    // Simple mode
    document.getElementById('simpleMode').addEventListener('change', e=>{
      document.querySelectorAll('aside, header .controls').forEach(el=> el.style.display = e.target.checked ? 'none' : 'flex');
    });

    // Small NOTE: For production, replace emoji with photos and add caregiver controls.
  </script>
</body>
</html>
